package com.fashion.binge.fashiondesign;import android.app.Activity;import android.content.Intent;import android.content.SharedPreferences;import android.content.pm.ActivityInfo;import android.graphics.Color;import android.os.Bundle;import android.preference.PreferenceManager;import android.support.design.widget.CoordinatorLayout;import android.support.design.widget.Snackbar;import android.support.v7.app.AppCompatActivity;import android.support.v7.widget.Toolbar;import android.view.MenuItem;import android.view.View;import android.widget.EditText;import android.widget.ImageView;import android.widget.TextView;import com.fashion.binge.fashiondesign.classes.SetStatusBarColor;import com.fashion.binge.fashiondesign.classes.Utils;import com.fashion.binge.fashiondesign.interfaces.AccessTokenInfoHolder;import com.fashion.binge.fashiondesign.interfaces.ResponseInfoHolder;import com.fashion.binge.fashiondesign.json.EditAddressAccount;import com.fashion.binge.fashiondesign.models.AddressModel;import com.fashion.binge.fashiondesign.shared_preference.SharedPrefrenceInfo;import com.fashion.binge.fashiondesign.sweetalertdialog.SweetAlertDialog;public class EditAddress extends AppCompatActivity {    private Toolbar toolbar;    private TextView toolbarTitle;    private EditText addressLineOne, addressLineTwo, city, postcode, country, firstName, lastName;    private ImageView cart,notification;    private CoordinatorLayout coordinatorLayout;    private TextView cartCount,notificationCount;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_edit_address);        if (!Homepage.isTablet(this)) {            setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);        }        initialiseLayout();        setSupportActionBar(toolbar);        //noinspection ConstantConditions        getSupportActionBar().setDisplayHomeAsUpEnabled(true);        SetStatusBarColor.setStausBarColor(this);        toolbarTitle.setText(R.string.edit_address);        Intent intent = getIntent();        addressLineOne.setText(intent.getStringExtra("address_line_one"));        addressLineTwo.setText(intent.getStringExtra("address_line_two"));        city.setText(intent.getStringExtra("city"));        postcode.setText(intent.getStringExtra("postcode"));        country.setText(intent.getStringExtra("country"));        String countryId = intent.getStringExtra("country_id");        String zoneId = intent.getStringExtra("zone_id");        firstName.setText(intent.getStringExtra("firstname"));        lastName.setText(intent.getStringExtra("lastname"));        final AddressModel addressModel = new AddressModel();        addressModel.setAddressOne(intent.getStringExtra("address_line_one"));        addressModel.setAddressTwo(intent.getStringExtra("address_line_two"));        addressModel.setCity(intent.getStringExtra("city"));        addressModel.setPostcode(intent.getStringExtra("postcode"));        addressModel.setCountry(intent.getStringExtra("country"));        addressModel.setAddressId(intent.getStringExtra("address_id"));        addressModel.setCountryId(countryId);        addressModel.setZoneId(zoneId);        addressModel.setFirstName(firstName.getText().toString());        addressModel.setLastName(lastName.getText().toString());        cartCount.setVisibility(View.GONE);        notification.setVisibility(View.GONE);        notificationCount.setVisibility(View.GONE);        cart.setImageResource(R.mipmap.tick);        cart.setColorFilter(Color.argb(255, 255, 255, 255));        cart.setAdjustViewBounds(true);        cart.setMaxHeight(55);        cart.setPadding(0, 15, 0, 0);        cart.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                if (firstName.getText().toString().equals("") || lastName.getText().toString().equals("") || addressLineOne.getText().toString().equals("") || city.getText().toString().equals("")) {                    Snackbar snackbar = Snackbar.make(coordinatorLayout, "All fields are mandatory", Snackbar.LENGTH_SHORT);                    View view = snackbar.getView();                    view.setBackgroundColor(Color.parseColor("#f66d63"));                    snackbar.show();                } else {                    editAddress(addressModel);                }            }        });    }    private void editAddress(final AddressModel addressModel) {        final SweetAlertDialog pDialog = new SweetAlertDialog(EditAddress.this, SweetAlertDialog.PROGRESS_TYPE);        SharedPreferences sharedPreferences = PreferenceManager.getDefaultSharedPreferences(EditAddress.this);        pDialog.getProgressHelper().setBarColor(Color.parseColor("#F6705E"));        pDialog.setTitleText("Editing your address");        pDialog.setCancelable(true);        pDialog.show();        new EditAddressAccount(EditAddress.this).editAddressAccount(pDialog, firstName.getText().toString(), lastName.getText().toString(), addressLineOne.getText().toString(), addressLineOne.getText().toString(), city.getText().toString(), addressModel.getAddressId(), sharedPreferences.getString(SharedPrefrenceInfo.TOKEN_TYPE, "") + " " + sharedPreferences.getString(SharedPrefrenceInfo.IS_TOKEN_VALID, ""), new ResponseInfoHolder() {            @Override            public void setFollowingInfo(String success, String data) {                if (success.equals("401")) {                    Utils.setTokenInfo(EditAddress.this, pDialog, new AccessTokenInfoHolder() {                        @Override                        public void setAcessTokenInfo(String accessToken, String expires_in, String token_type) {                            pDialog.dismissWithAnimation();                            editAddress(addressModel);                        }                    });                } else {                    if (success.equals("true")) {                        pDialog.changeAlertType(SweetAlertDialog.SUCCESS_TYPE);                        pDialog.setTitleText("Successfully edited address");                        pDialog.setConfirmClickListener(new SweetAlertDialog.OnSweetClickListener() {                            @Override                            public void onClick(SweetAlertDialog sweetAlertDialog) {                                pDialog.dismissWithAnimation();                                Intent returnIntent = new Intent();                                returnIntent.putExtra("address_one", addressLineOne.getText().toString());                                returnIntent.putExtra("address_two", addressLineTwo.getText().toString());                                returnIntent.putExtra("city", city.getText().toString());                                returnIntent.putExtra("postcode", postcode.getText().toString());                                returnIntent.putExtra("country", country.getText().toString());                                setResult(Activity.RESULT_OK, returnIntent);                                finish();                            }                        });                    } else {                        pDialog.changeAlertType(SweetAlertDialog.WARNING_TYPE);                        pDialog.setTitleText(data);                    }                }            }        });    }    private void initialiseLayout() {        toolbar = (Toolbar) findViewById(R.id.toolbar);        toolbarTitle = (TextView) findViewById(R.id.toolbar_title);        addressLineOne = (EditText) findViewById(R.id.address_line_one);        addressLineTwo = (EditText) findViewById(R.id.address_line_two);        city = (EditText) findViewById(R.id.city);        postcode = (EditText) findViewById(R.id.postcode);        country = (EditText) findViewById(R.id.country);        cart = (ImageView) findViewById(R.id.cart);        coordinatorLayout = (CoordinatorLayout) findViewById(R.id.coordinator_layout);        firstName = (EditText) findViewById(R.id.first_name);        lastName = (EditText) findViewById(R.id.last_name);        cartCount=(TextView)findViewById(R.id.cart_number);        notification=(ImageView)findViewById(R.id.notification);        notificationCount=(TextView)findViewById(R.id.notification_number);    }    @Override    public boolean onOptionsItemSelected(MenuItem item) {        int id = item.getItemId();        if (id == android.R.id.home) {            finish();            return true;        }        return super.onOptionsItemSelected(item);    }}